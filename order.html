<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order Page</title>
    <style>
      .bg-container {
        display: flex;
        align-items: center;
        flex-direction: column;
        justify-content: center;
      }
      button {
        width: 250px;
        background-color: darkcyan;
        color: white;
      }
      #orderStatus {
        color: indianred;
      }
    </style>
  </head>
  <body>
    <div class="bg-container">
      <h1>Your Order</h1>
      <div id="cartItems"></div>
      <button id="orderButton">Place Order</button>
      <div id="orderStatus"></div>
    </div>

    <script>
      let cart = JSON.parse(localStorage.getItem("cart")) || {};

      function displayCart() {
        const cartItemsContainer = document.getElementById("cartItems");
        cartItemsContainer.innerHTML = "";

        if (cart.length === 0) {
          cartItemsContainer.textContent = "No items in cart";
          return;
        }

        cartItemsContainer.innerHTML = "";

        let totalAmount = 0;

        for (const itemId in cart) {
          const item = cart[itemId];

          console.log(`Item ID: ${itemId}, Item:`, item);

          console.log(`Processing item:`, item);

          const price = Number(item.price.replace("$", "")) || 1;
          const quantity = Number(item.quantity) || 1;

          cartItemsContainer.innerHTML += `<p>${item.Name} - $${price} x ${quantity}</p>`;

          totalAmount += price * quantity;
        }

        cartItemsContainer.innerHTML += `<h3>Total: $${totalAmount}</h3>`;
      }

      displayCart();

      const orderButton = document.getElementById("orderButton");
      orderButton.addEventListener("click", function () {
        if (cart.length === 0) {
          document.getElementById("orderStatus").textContent =
            "Your cart is empty. Please add items to the cart.";
        } else {
          selectPaymentMethod();
        }
      });

      function selectPaymentMethod() {
        const paymentMethod = prompt(
          "Select payment method: \n1. PayPal\n2. MasterCard\n3. Visa\n4. American Express"
        );

        if (paymentMethod === "1" || paymentMethod.toLowerCase() === "paypal") {
          processPayment("PayPal");
        } else if (
          paymentMethod === "2" ||
          paymentMethod.toLowerCase() === "mastercard"
        ) {
          processPayment("MasterCard");
        } else if (
          paymentMethod === "3" ||
          paymentMethod.toLowerCase() === "visa"
        ) {
          processPayment("Visa");
        } else if (
          paymentMethod === "4" ||
          paymentMethod.toLowerCase() === "american express"
        ) {
          processPayment("American Express");
        } else {
          document.getElementById("orderStatus").textContent =
            "Invalid payment method selected. Please try again.";
        }
      }

      function processPayment(method) {
        orderButton.disabled = true;
        orderButton.textContent = `Processing payment with ${method}...`;

        setTimeout(() => {
          document.getElementById(
            "orderStatus"
          ).textContent = `Your order has been placed successfully using ${method}!`;
          orderButton.textContent = "Order Placed";

          localStorage.removeItem("cart");
          cart = {};
          displayCart();
        }, 2000);
      }
    </script>
  </body>
</html>
